//
//  KeystoneTronSDKTests.swift
//  
//
//  Created by LiYan on 4/12/23.
//

import Foundation

import Foundation
import XCTest
import URKit
@testable import KeystoneSDK


final class KeystoneZcashSDKTests: XCTestCase {
    // mock timestamp to get same ur code
    override func setUp() {
        super.setUp()
        func stubCurrentTimestamp() -> Int64 { return 1681871353647}
        Date.currentTimestamp = stubCurrentTimestamp
    }
    
    
    func testGenerateSignRequest() {
        let pcztHex = "50435a5401000000058ace9cb502d5a09cc70c0100a8ade204850100000101010101010101010101010101010101010101010101010101010101010101010100000000c0843d1976a9149517c77b7fcc08e66122dccb6ee6713eb7712d2b88ac00000100000000000000000000fbc2f4300c01f0b7820d00e3347c8da4ee614674376cbc45359daa54f9b5493e01000000000000000000000000000000000000000000000000000000000000000002ff42eb582652f01a035397891789790d42c958f32f2c4bf9204a5f96c353fe3f6c9ebdbb06ddff0fdd74ea68dd6d03e97eebc181750144dabcc3a480d8f43724121290cfa041b3417b24e8bff8456d8422354ab8ba891890197302dda938fe3201eebe46b9b086a37cf1d24d5d1f19f7a5535a40315e546679899b4608f6dfd2849bb80f09e4b2b8366256b0fb9f71e66e3b61ab937bcbdf82b36f49be7c36362d01835534348dc1ccca7fc97e63869c5fc392913d72ff1b1bc7904513e3711320dd5eefd970acfed1b9a7e7270100018e36771d18d142b72fd67d220504345d038457cb64265de833e707a1080fa92f01dc91a1f4523d9d255b50553f42038b29b80b0af18e8b2c5323fbdc5ffe74b41f01443a9e91da013833f3b557f6c5e43f88fc808d1d034e2eb8fa9d0541f53e34235d9a8517b6748487a9843907220f5671a99e67d27c9253cdbc79a54a2ea1c71cdba9903b6c418783ef1e25eeb1f1f81344fc085b29f1a4289b4a0c35bcd2f80401fadceec70c883521596ff393dedc0ac9b258f5099ae18cc2b698a95af2f8c06973f91149306847a9b4055c5e4095cee3f19c69d230540b32accca7e2eac163457ed5324a116f0f2f00dd7ac80da04cb39aac361e6f3f0c2650c0453a1a81a4b4f2b6b27e2231b38c787ec4296c21c46272fdbad294375006c5b581acc5e0c6d560ba87e00dd4cbdf1489dd887f208549195bee6d5734982ae015076f7a1bbef59ebda0d504b3f7a814116a32f7792838ebf93a713134306ce1e892d03d882e3db2c63fd41fce6c733a74ef07cb95258704e1526017290fd82a545257cca9e8eb102665ae209f3b68fb7b37c2d1bafdece13acf69ab26a419d29a755ece8bc42783d08a2912569d71d0af19b31441105630a4e0a339994c7746809fc5f838c72be73eca4d16682b49abe5ef9fc3748cbcd486354f1e98ac5bd290fc9a9d86e30b9a7858ed3593c9d1ccbed527c652dcbe4a573df6781ecbe7791e18c0af87d174d110ad833465b68bb697a79130128d27e7a74be677ad7955e24a600aed152aa8872e5bde2440541246f9127931884aa7cec48af7eb90bcd020349ccbc6379daa3d9d3a4d3eab87594051197faa55b46a75c20180cbb6f5233684f12ba17014687b63a75a01b0e8a477eaf3e9a1e4fad6c36e03bf158eb588c73dda7732a9d9fa1c4d9b283a391a3cf544ce34d1bb661b9f39fda7511803b0977354661d316fb34adf45082def1864221f0880632cb9f5751b0e09a8daa990a8140c0c88ca232bcc70be5b24d98dc77b440c376e091a1dbf17d8a1e6c588e2d803f70db1d7f3e93e9f38b72d1ce21bb0a4ab24ae158b2b50391e68dc72201bf4f45b1776e48463b4cce7e60d596cb2470503bbdd891ae3cdc7654dc629a632d0db972e36d9d98a975fda783f32a2b873ed51410e5e04f0554e0f749105695671945450a8071e962b6169a939e647744382dbf2fd809852f486332050b7fd39b9618fe22515fdeeab27a2b13474e281b45a07e5fc617f546ef736978ffdc9f67a0ff79d9f84b9bd15eec2c21442db33a8b1f0a386cd37bfd7418ab22aac4fa417ca3fc120493e5d64caf9da1fd2618d7522d5e590404b88c783148099723b2fee724fd9652382345c16ed711536c3201d0ab8b517c338b5cbecd732b29fac9eeb2a49104a102a27f47d147b25232b37edeee8ea7144104034e225098fc3693b6ec49ccc183501acfa3d2fad05e61aeb879443a85d0cf3af9f3a5d8fa3e1c39472adedf008d62c2a3ea9101a03d0dc140f8cd9c5c895980e00fc5ce1eb9b3f0b52d66dbb14183b477526cee310c5ffc56a64d3a0c34c5026a37c31282d913e65ea6c79c4eea70758353d38f538c89b135cde5b1dad9239b4ddda6f2f878dbf8ae398a54269fa5cfa391be1d815fb33c4cda89469fb4b5299fdc81cbcb9fba78e5fd7f4404cff328e30f424071d016b2967bef8d6031837c8aa14476b2a674d4fede6f0dafd2560686a27e13c8415000000475506a99684042a0576c5523403be08b3b116936ff651b999eccd815ff14a1d4ace57cfd6db3e7ce0044b7d93cd96581bd9a9373de3ed62bec2a66eb0516f29c4041a692e0ee65a37e50483b19b9b3c3a788f4907d6b5317af743f19e7438d9822d62bf3e0d33daeacb3eb4b12775c5f87d9ab625eef8c6cb49d3af60d821019fc7899a4541e47ff60df338880a944b3b582e6f87ec492546068ca7e2f26d0d501db344fe1d34c69c71480645b48aa431ecec38e76d254453f2defb584b60eaca9419bd8fa2f20f17e7f47532d986a9505b3f437e24226024f47e21e646c9cb0350dbc4383f06f02d9c18dbfab194ce39d079b2b03ec038b0871069f243f543e05951b2b743cd7ac86e1f7f4fec45c4bc67fe555dcf3e4567a20ca09d7058744a52e79848e45ec6a0796fede0b8cae431dbffdfeddcde609a4df5b2c3d8cdaf7fde98b8b7834903e53a424f52f2c2fd6b98a62faf9b44625238a47fac9cd3cfe171cdf2afaca99f5ee9e8adac033ea00ceaa02f35d8ce366c1f6b3f75585a2a86f519031f81db0ec212bf655907ef6c1fdb88757345d6bf103d7235730e325e204e9ef4efec51676f29d96f4812ddb96b95be615fbec448e4d2d571bdde98e8c80dccc4e50c4b8f5260f5c59da41fff88e2a8197db523d29eecbc4bc61ed6f4f4c1d683061334eb8b5ecc1cf375446a34455b0da3dc1408fae804ac98fca1c1a1050bad78cd943ea3a4deb1ccbccb89e4588c44a5084244a7eb91ded4318463516bfed135eef247e694ca3c4b7d2ed85e668988c9f2c2bb36b33bdc315e3849388be069e4bf4b66a79b3693ae89d60959842a152b25370b8922812e2cecef3b8581bcebb940a0b6120eae4f7b07baff5cd4593317b152b10e8dc80c89bb97df741a442ff9325074d4168739839b932be8b3a556e6cc8bd5f93ed781a17e4eb03edb1ad2fb9b5ba925218a3775f0dec271298f171f8ebe884d23a1fb29b387b3c5455a59d4cbebc359999715673b2596a500bf72c2463a01d288df138de809fa058e8b7b240650cb1aae966ea3614fc54db414e8294066e8936b02d96b006cbfffc52701a08d0601912cb10c2798fe4cb67d4f79c1aea53d569edfcf1a1a4faa3de0a2dfb7055c1300000001a094318d16d3ec9233df1c9b8dcebc2965ebba5b28d164f26346f2928d594224d227296494a5261e7cb36e2009d0e719e75926fff6a9f28f84d5e61c597e1ebc08c31a3018d4efb10fc382bd9abfc2a0a0822f16d76eb0ad194e67270a2e18112530a8c9ccef426a601872791259053e80291186a795877cd6d11611b522920001325f587457c6d384daf5c31a79d7d7bc231c8adab6457ae3313c04ee7ee2a091dbbbf25512dbc5218b7a701da4d1c34c21cc454336faf16bb770589a214e6d25018d27f0dfe9cc4de89164e7ebcf2c8c5b9756ece33a31064148a162a9ed3ef06ba4ca136c547caa09c4e4920100010d91402a0e313f8b62db5e3a4417d644971b1c6a3867cca21067662fb81d6518019f8130645a0ce9e35d1e0c7d88c4054620aab9b9288c6d3b92ecc9647ac689a501e3cc94b0cf67c7f646e085bc74c62040110bc91a42693af32e9f7ee378edcb14818445c8477986cdb7415aa4d9f47b1e43a9878ba2b4e60cd3f145fc978fdd2d365b052148852b72d66de898b731173e2b152745cf0b4d4bd136afbab37dd00701c5dd8cc70a632970a1752cddbe074f81812bbf2d1c23685902a295a3aa54de9e442519ff0d455a508c018b2353e2e518ce05a0da57c8a207dd1ca7003aad3f690d1efac925e5193ef5a5df128f6b1c19c2425540cd8194c960e232e2ea9bc847c94a71e701759e6714e5294380515b8f802ae4510270250f87b3780aed8740aeee25d39b268022bc1d243a14f469bb0eb5a43202c0e9ef3f6e4138443b5e4dcb940d60c60a2e25fded86a009f6688f836717833bb5018c753caeacb3f7d25f3446b8ba011e08eaced4f8936e7d298ab4a29e68c1b8abe6edde890d66f26d255b2d9e302c2c58d4760c8833367326be9215f8f692bf709946df1f88a2907df5772dc6930d25302acf80c521b09b81bb0bbfe27e042d7004f71744fc3f931d471508ed0ef317239aedb92d408f97e70b4321f195dfa0cedd89bd99685c2271959d27bfeb6324628399d5f4cd7dacc122ac53248acd1e2090e2a701e88e930f1a1d3ab4277402916e8837bf68dcea82c996ae0fbe218ef790db4e33a42c4492e37f48c8960f2ca0fa7a837cbe968df014353fc361d55ab81c591b6390a1c82f54432ab4ab300be01ee9e7f566188d1e9c3c69a88b14ed81c74568743a88834c28917ae2e6ed25a64f9dd4f2ea0fd024111c8a06ab07f18aafdf423067565694efc90608b6c8073dc55b5ffa425311c20a3777f3aeb9c656422a8176ea0213dd35affcbd3cdb182c065b4fb4ebb2fd9923db2049179e21665fcb0c059b10a6da658429b3b6723a677a7ab121321588117f9e5355d5f57f625d2f1d4c0fd21798f571e5f0a57e26500803ae3afdc43d32e88da1cefa5c26e49c6f8f2698e7a0dead4451fe3377363c31689f7920c1bb1d4c934f93cb31359d7e57ec6b18b8ea1c75af45f335b13958df709ff6a052758d009be44952a8bfbba193692cdbdd3631675a45e225ec39adfd15730937cdf8f37cbec82a44d88fa0b9085866fa0c371927b2a8d315161e88a3040443260e0c7fca7eb932ca1ac81869fcc277a043e7f21363de11574114c741e11b9ed3fc2ed6725742312e42394849331b9489beca561b84a2c6c6610c244dfd39a84d831947b2723965dc2788af70622cb33610ea1fbb89a04a69ff3e5730c524e6ac1fd7034ce9ed3a9227531a007e1932b050a2bf3c2b36f4d7291b8db00b4e7455fd804e21d4af6f7d3b7dd07770f2923b00d1f6f49b1f65f32c18428d2f1829c2f87ab5dce1070a48e9573a5d8110e169367e36f9b9b4ec1fea233e67ec2b9a3b97c6ef0b73aedb98a112f9d4772fe8bc1334fb2aa92a9d2ede06b06228086396e630fab05bfab23143c9d7caf26807d220763beff37e426f131078b10a2d3f34d3f6c7571b10992a163e9daee19b8dabd53a6207d109a83e182072a345f6d442cc6d0dd861ab58f44505e4f71795561327d084cd67de19253524010cae70dbcebd5a4ae02c96572083b2520d40166e8bb77a6e8bf168fd190af40f00000037e7d6b86ae8af39d95fae02e9eef8b7ded2a9b002d0df8b1680caf63b037813384fb1caaaeda27b5c808011e5f8aa2b4d8b5345ebd325251a18fa3f65973813c4044d65b8310a9285ca45ece2e41621edece617fbdcb2aeb2b537c418aff26b6c9ae5b419c00a07bfc268fd7bf6340b6949b551835dc2969375af8fce0e7c622897d637632f454e72f0b03792136d38362bfac9382167034fd40e4ae6a130362fd8f7cecffc83157b131023cdeb54cf6a5287f2b7ffa88ee7b303dad3efd46ea8348ccf503d61f238371532eb903f2c5e88bf87d6d5da965a9aba5b689d654c3f1d40bb9b23e21ecc35c37c3afdf090a65bb12b532d69d7649a310b5825fdace5aad87113dd674f15c2a1eb6967b7a1a5096af1c2e3eee1cb23e437e67fdf0de23b9e1e86be4a435b15eeb79f671d23dbc798cccfab6ccc3f0c71828152e0cefe8c714af6e989d208fae6266fd85670a4e0e32ae23e696b43a0bae0e6d7c2ab8b7b628eb557607bdf3f9ce8f6bc49974f833b9c52ba11baa2b8bab730314da619ba47804d0007089c6d7c2ce6e4f72173d252dce881cbcf7dd91faed9383eba33fc559ca6f859cf2cd7fde167804de8e069ad8dbbc527ae39e94364556cbb55736d2c1f09b6c140615782e5f3f892189c1d8108d3523408beffe50fc71e69dcaf0f58236b8bc98a5d021695c165729d3bd7c2fed018bce6f056dc5e8ae0335cbe161372357af647fda49c17f7583c8de86fb8a26094c752e07e9826eb9f60499d7a386abde87ab7eec02025cf6d2ed060305bb043dd75519ff0a66cb7483bbbbd4c011c7a1c49148bdddce483d8cfb88883f90851e8a3695ae0e1e4b92a79b9947cac7135560238b152bc646351760da5d487038cf21f3280058039310c95cdaeeb6389be285007fa5400253e4a3968cc262d11feca95140206092dc46767dcf33f3d0831c5e85a864a18cc849467ab1225dafc07a13a8919b33084c4d31c589bd844fd7e0abef31fa3977f3cd8c8e4d71826a02ac8a50114b0cac3e14c4e1a4a4fd22c98563b9cbe859c67768a39f67abd5dbe55d3d16ff58e5c45b21d8c573f54b901888236018d6305574f52b75e5dd7b065d9ab1f7040853e0bd1709ef648f730d5cd50082d00000001a9ab33f6aa9ee3ba697b445ad9a1e46337c593c8c033900ded3d3c1a33be433e03a88f3c01ae2935f1dfd8a24aed7c70df7de3a668eb7a49b1319880dde2bbd9031ae5d82f000148406583a08689c1bfb1cceb6ad75a6b9cb04e24e904f5ff50842eadc0178622"

        let zcashSDK = KeystoneZcashSDK()
        let pcztEncoder = try! zcashSDK.generateZcashPczt(pczt_hex:         pcztHex.hexadecimal)

        
        let qrCode = pcztEncoder.nextPart()

        XCTAssertEqual(qrCode, "ur:zcash-pczt/1-13/lpadbtcfbgsbcygtlydsishkadjkoyadhkbgswgdfxhtghadaeaeaeahletonsreaotlnbnsstbnadaepdpmvoaalpadaeaeadadadadadadadadadadadadadadadadadadadadadadadadadadadadadadadadadadaeaeaeaertlrfscfkoptbbmdchstkglbsfayvahscpuosbjtvajsfmrljsdpdnlopsaeaeadaeaeaeaeaeaeaeaeaeaezosawkdybnadwtrllfbtaevleekelgoxwyhsfgjyemjzrffeecntpkghytregafmadaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaeaozmfwwmhddsgmwtcyaxgumsldchldkkbtfwsohdwfdldwgrytcxgehemtsrguzefhjznnryrkamutzmbsutjywdisutjnaxwlkbwmselykpadfytnrfsroxlatpwkemdkbgbgmhtknbfpqdfpkgdkvsrsyafejnlrcpecgerordldcsmhcfjkaoutptetzeeyadwyrnfgrhpflnotkewntdgthlctcfylonguhtfzehhyghiykkldndfgayynurtdlrndrobsasveprroenidhfpfzonejsvajtfrhspymukgsburlfqdjlgarnkeenendpadlsgoeeeelgsesfsglbsokbialnnshesrmomefsjpzmcwcwstmhfebwvljsdkcxmwbw")
    }
}
